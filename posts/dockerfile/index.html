<!DOCTYPE html>
<html><head>
<title>Dockerfile</title>




<meta charset="utf-8">
<meta name="X-UA-Compatible" content="IE=edge">
<meta name="google-site-verification" content="">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
<meta content="telephone=no" name="format-detection">
<meta name="description" content="Esmeralda">
<meta name="renderer" content="webkit">
<meta name="theme-color" content="#ffffff">



<meta property="og:title" content="Dockerfile" />
<meta property="og:description" content="Esmeralda" />
<meta property="og:type" content="article" />
<meta property="og:url" content="localhost/posts/dockerfile/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-11-23T16:08:08-04:00" />
<meta property="article:modified_time" content="2023-11-23T16:08:08-04:00" /><meta property="og:site_name" content="My Blog" />






<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dockerfile"/>
<meta name="twitter:description" content="Esmeralda"/>









<script type="text/javascript">
  (function(c,l,a,r,i,t,y){
      c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
      t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
      y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
  })(window, document, "clarity", "script", "abcdefghzd");
</script>



  






      <script src="/localhost/js/toc.js"></script>
    
    <link type="text/css" rel="stylesheet" href="/localhost/vendor/css/bootstrap.min.css">

<link rel="stylesheet" href="/localhost/scss/dark-mode.min.cb53f1bee2b8900cb4f082afbf00175d6618f281cf9a2fe8619e3b52d20b5721.css" integrity="sha256-y1PxvuK4kAy08IKvvwAXXWYY8oHPmi/oYZ47UtILVyE=" media="screen">


<link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Material+Icons">


















<script>console.log("Hello from 'layouts/partials/extended_head.html'")</script>

</head>
<body>
    	<div id="app"><div class="single-column-drawer-container" id="drawer"
     v-bind:class="{ 'single-column-drawer-container-active': isDrawerOpen }">
    <div class="drawer-content">
        <div class="drawer-menu">
            
            
            
                
                
                
                    
                
                
                
                <a class="a-block drawer-menu-item active" href="localhost/posts">
                    Archive
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="localhost/categories">
                    Categories
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="localhost/tags">
                    Tags
                </a>
                
            
                
                
                
                
                
                <a class="a-block drawer-menu-item false" href="localhost/index.xml">
                    RSS Feed
                </a>
                
            
            
            <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#dockerfile" class="nav-dockerfile">
									Dockerfile
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8c%87%e4%bb%a4" class="nav-指令">
									指令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#cmd" class="nav-cmd">
									CMD
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#entrypoint" class="nav-entrypoint">
									ENTRYPOINT
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#cmd%e4%b8%8eentrypoint%e6%80%bb%e7%bb%93" class="nav-cmd与entrypoint总结">
									CMD与ENTRYPOINT总结
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#add" class="nav-add">
									ADD
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#copy" class="nav-copy">
									copy
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#dockerfile%e6%96%87%e4%bb%b6%e5%86%85%e5%ae%b9" class="nav-dockerfile文件内容">
									Dockerfile文件内容
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%82%ac%e8%99%9a%e9%95%9c%e5%83%8f" class="nav-悬虚镜像">
									悬虚镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%88%a0%e9%99%a4%e6%82%ac%e8%99%9a%e9%95%9c%e5%83%8f" class="nav-删除悬虚镜像">
									删除悬虚镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#build-cache" class="nav-build-cache">
									build cache
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e7%94%9f%e6%88%90%e8%bf%87%e7%a8%8b" class="nav-镜像生成过程">
									镜像生成过程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#docker-build-cache%e6%9c%ba%e5%88%b6" class="nav-docker-build-cache机制">
									docker build cache机制
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#build-cache-%e5%a4%b1%e6%95%88" class="nav-build-cache-失效">
									build cache 失效
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%85%e7%90%86%e6%82%ac%e8%99%9abuild-cache" class="nav-清理悬虚build-cache">
									清理悬虚build cache
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
            
        </div>
    </div>
</div>
<transition name="fade">
    <div id="drawer-mask" v-bind:class="{ 'single-column-drawer-mask': mounted }" v-if="isDrawerOpen" v-on:click="toggleDrawer"></div>
</transition>
<nav id="navBar" class="navbar sticky-top navbar-light single-column-nav-container">
    <div id="navBackground" class="nav-background"></div>
    <div class="container container-narrow nav-content">
        <button id="nav_dropdown_btn" class="nav-dropdown-toggle" type="button" v-on:click="toggleDrawer">
            <i class="material-icons">
                menu
            </i>
        </button>
        <a id="navTitle" class="navbar-brand" href="localhost">
            My Site
        </a>
        
        <button type="button" class="nav-darkmode-toggle" id="darkModeToggleButton2">
            <i class="material-icons" id="darkModeToggleIcon2">
                dark_mode
            </i>
        </button>
        
    </div>
</nav>
<div class="single-column-header-container" id="pageHead"
     v-bind:style="{ transform: 'translateZ(0px) translateY('+.3*scrollY+'px)', opacity: 1-navOpacity }">
    <a href="localhost">
        <div class="single-column-header-title">My Site</div>
        
        <div class="single-column-header-subtitle">Themed by Diary.</div>
        

    </a>
</div>

            <div id="content">
                <div id="streamContainer" class="stream-container">

    <div class="post-list-container post-list-container-shadow">
        <div class="post">
            
            
            
                
            

            <div class="post-head-wrapper"
                
                    
                    
                    style="background-image: url('/images/esmeralda.jpg')"
                    
                
            >
                <div class="post-title">
                    Dockerfile
                    
                    <div class="post-subtitle">
                        Esmeralda
                    </div>
                    
                    <div class="post-meta">
                        
                        <time itemprop="datePublished">
                            2023-11-23 16:08
                        </time>
                        

                        
                            <i class="material-icons" style="">folder</i>
                                <a href="/categories/docker">docker</a>
                                &nbsp;
                        

                        
                        
                    </div>
                </div>
            </div>
            
            <div class="post-body-wrapper">
                
                <div class="post-body" v-pre>
                
                    <h2 id="dockerfile">Dockerfile</h2>
<p>Dockerfile 是用于构建 Docker 镜像的脚本文件，由一系列指令构成。通过 docker build命令构建镜像时，Dockerfile 中的指令会由上到下依次执行，每条指令都将会构建出一个镜像。这就是镜像的分层。因此，指令越多，层次就越多，创建的镜像就越多，效率就越低，所以在定义 Dockerfile 时，能在一个指令完成的动作就不要分为两条。</p>
<h2 id="指令">指令</h2>
<ul>
<li>大小写不敏感，惯例时全大写</li>
<li>指令后至少携带一个参数</li>
<li>#号开头为注释</li>
</ul>
<h4 id="cmd">CMD</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">CMD</span> [<span style="color:#cd5555">&#34;EXECUTABLE&#34;</span>, <span style="color:#cd5555">&#34;PARAM1&#34;</span>, <span style="color:#cd5555">&#34;PARAM2&#34;</span>,<span style="color:#a61717;background-color:#e3d2d2">...</span>]<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 执行EXECUTABLE可执行文件，后面的参数为运行参数</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">CMD</span> <span style="color:#658b00">command</span> param1 param2,...<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># command是 shell命令</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">CMD</span> [<span style="color:#cd5555">&#34;PARAM1&#34;</span>, <span style="color:#cd5555">&#34;PARAM2&#34;</span>,<span style="color:#a61717;background-color:#e3d2d2">...</span>]<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 提供给ENTERYPOINT的默认参数</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><p>Dockerfile 中的[command]或[“EXECUTABLE”]如果是通过 CMD 指定的，则该镜像的启动命令 docker run 中是不能添加参数[ARG]的。因为 Dockerfile 中的 CMD 是可以被命令中的[COMMAND]替代的。如果命令中的 IMAGE 后仍有内容，此时对于 docker daemon 来说，其首先认为是替代用的[COMMAND]，如果有两个或两个以上的内容，后面的内容才会认为是[ARG]。所以，添加的-y 会报错，因为没有-y 这样的[COMMAND]。</p>
<h4 id="entrypoint">ENTRYPOINT</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ENTRYPOINT</span> [<span style="color:#cd5555">&#34;EXECUTABLE&#34;</span>, <span style="color:#cd5555">&#34;PARAM1&#34;</span>, <span style="color:#cd5555">&#34;PARAM2&#34;</span>,<span style="color:#a61717;background-color:#e3d2d2">...</span>]<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># 调用EXECUTABLE应用程序，后面是两个参数</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ENTRYPOINT</span> <span style="color:#658b00">command</span> param1 param2,...<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#228b22"># command是shell命令</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><p>Dockerfile 中的[command]或[“EXECUTABLE”]如果是通过 ENTRYPOINT 指定的，则该镜像的启动命令 docker run 中是可以添加参数[ARG]的。因为 Dockerfile 中的 ENTRYPOINT 是不能被命令中的[COMMAND]替代的。如果命令中的IMAGE 后仍有内容，此时对于 docker daemon来说，其只能是[ARG]。</p>
<h4 id="cmd与entrypoint总结">CMD与ENTRYPOINT总结</h4>
<p>不过，docker daemon 对于 ENTRYPOINT 指定的[command]与[“EXECUTABLE”]的处理方式是不同的。如果是[command]指定的 shell，daemon 会直接运行，而不会与 docker run 中的[ARG]进行拼接后运行:如果是“EXECUTABLE”指定的命令，daemon 则会先与docker run中的[ARG]进行拼接，然后再运行拼接后的结果。</p>
<p>无论是CMD还是ENTRYPOINT，使用[&lsquo;EXECUTABLE&rsquo;]方式的通用性会更强</p>
<h4 id="add">ADD</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">ADD</span> &lt;src&gt; &lt;dest&gt;<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">ADD</span> [<span style="color:#cd5555">&#34;&lt;src&gt;&#34;</span>, <span style="color:#cd5555">&#34;&lt;dest&gt;&#34;</span>]<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><p>该指令将复制当前宿主机中指定文件 src 到容器中的指定目录 dest 中。src 可以是宿主机中的绝对路径，也可以时相对路径。但相对路径是相对于 docker build 命令所指定的路径的。src 指定的文件可以是一个压缩文件，压缩文件复制到容器后会自动解压为目录;src 也可以是一个 URL，此时的 ADD 指令相当于 wget 命令; src 最好不要是目录，其会将该目录中所有内容复制到容器的指定目录中。dest 是一个绝对路径，其最后面的路径必须要加上斜杠，否则系统会将最后的目录名称当做是文件名的。</p>
<h4 id="copy">copy</h4>
<p>功能与ADD相同，但是src不能是URL，且当src为压缩文件时，复制到容器后不会自动解压。</p>
<h2 id="dockerfile文件内容">Dockerfile文件内容</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> centos:7   # 基础镜像信息</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">MAINTAINER</span><span style="color:#cd5555"> lin lin@qq.com   # 维护者信息</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">WORKDIR</span><span style="color:#cd5555"> /usr   # 容器打开后默认进入的目录</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">WORKDIR</span><span style="color:#cd5555"> local   # 后续的WORKDIR会基于之前的路径</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> yum install -y wget vim net-tools   <span style="color:#228b22"># </span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">CMD</span> /bin/bash<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><h2 id="悬虚镜像">悬虚镜像</h2>
<p>悬虚镜像是指既没有 Repository 又没有 Tag 的镜像。当新建了一个镜像后，为该镜像指定了一个已经存在的 TAG，那么原来的镜像就会变为悬虚镜像。
为了演示悬虚镜像的生成过程，这里先修改前面定义的 Dockerfile，然后再生成镜像，且生成的新的镜像与前面构建的镜像的名称与 Tag 均相同。</p>
<h3 id="删除悬虚镜像">删除悬虚镜像</h3>
<ul>
<li>docker rmi &lt;imageID&gt;   指定imageID指定删除</li>
<li>docker image prune    一次性删除本地所有悬虚镜像</li>
</ul>
<h2 id="build-cache">build cache</h2>
<p>例子：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#eed;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#8b008b;font-weight:bold">FROM</span><span style="color:#cd5555"> centos:7</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">LABEL</span> <span style="color:#00688b">auth</span> = <span style="color:#cd5555">&#34;Tom&#34;</span><span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">COPY</span> hello.log /var/log/<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">RUN</span> yum -y install vim<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2"></span><span style="color:#8b008b;font-weight:bold">CMD</span> /bin/bash<span style="color:#a61717;background-color:#e3d2d2">
</span></span></span></code></pre></div><h3 id="镜像生成过程">镜像生成过程</h3>
<ul>
<li>FROM centos:7</li>
</ul>
<p>FROM 指令为最终构建出的镜像设定了一个基础镜像。该语句不会产生新的镜像层，它是使用指定的镜像作为基础镜像层的。</p>
<ul>
<li>LABEL auth=&ldquo;Tom&rdquo;</li>
</ul>
<p>LABEL指令也会生成一个新的镜像层，该镜像层中记录了json文件内容的修改变化，没有文件系统的变化。</p>
<p>如果该指令就是最后一条指令,那么此时形成的镜像的文件系统其实就是原来 FROM 后指定镜像的文件系统，只是 json 文件发生了变化。但由于 ison 文件内容发生了变化，所以产生了新的镜像层。</p>
<ul>
<li>COPY hello.log /var/log/</li>
</ul>
<p>COPY 指令会将宿主机中的指定文件复制到容器中的指定目录，所以会改变该镜像层文件系统大小,并生成新的镜像层文件系统内容，从而导致json文件中的镜像ID发生变化，产生了新的镜像层。</p>
<ul>
<li>RUN yum -y install vim</li>
</ul>
<p>RUN 指令本身并不会改变镜像层文件系统大小，但由于其 RUN 的命令是 yum install,而该命令运行的结果是下载并安装一个工具，所以导致 RUN 命令最终也改变了镜像层文件系统大小，所以也就生成了新的镜像层文件系统内容。所以json 文件中的镜像 ID 也就发生了变化，产生了新的镜像层。</p>
<ul>
<li>CMD /bin/bash</li>
</ul>
<p>对于 CMD 或 ENTRYPOINT 指令，其是不会改变镜像层文件系统大小的，因为其不会在docker build 过程中执行。所以该条指令没有改变镜像层文件系统大小。</p>
<p>但对于 CMD 或 ENTRYPOINT 指令，由于其是将来容器启动后要执行的命令，所以会将该条指令写入到 json 文件中，会引发 json 文件的变化。所以json 文件中的镜像 ID 也就发生了变化，产生了新的镜像层。</p>
<h3 id="docker-build-cache机制">docker build cache机制</h3>
<p>Docker Daemnon 通过 Dockerfile 构建镜像时，当发现即将新构建出的镜像(层)与本地已存在的某镜像(层)重复时，默认会复用已存在镜像(层)而不是重新构建新的镜像(层)，这种机制称为 docker build cache 机制。该机制不仅加快了镜像的构建过程，同时也大量节省了Docker 宿主机的空间。</p>
<p>docker build cache 并不是占用内存的 cache，而是一种对磁盘中相应镜像层的检索、复用机制。所以，无论是关闭 Docker 引擎，还是重启 Docker 宿主机，只要该镜像(层)存在于本地，那么就会复用。</p>
<h3 id="build-cache-失效">build cache 失效</h3>
<p>产生一下三种变化后，从发生变化的指令层开始所有的镜像层cache全部失效。即从该指令行开始的镜像层将构建出新的镜像层，而不再使用 buildcache，即使后面的指令并未发生变化。因为镜像关系本质上是一种树状关系，只要其上层节点变了，那么该发生变化节点的所有下层节点也就全部变化了</p>
<ul>
<li>Dockerfile文件发生变化</li>
<li>ADD或COPY指令内容发生变化</li>
<li>RUN指令外部依赖变化</li>
<li>指定不使用build cache</li>
</ul>
<p>有些时候为了确保在镜像构建过程中使用到新的数据，在镜像构建 docker build 时，通过&ndash;no-cache 选项指定不使用 build cache。</p>
<h3 id="清理悬虚build-cache">清理悬虚build cache</h3>
<p>指无法使用的build  cache，一般是悬虚镜像产生的build cache。</p>
<p>通过docker system prune 清除</p>

                    
                    <HR width="100%" id="EOF">
		    <p style="color:#777;">最后修改于 2023-11-23</p>
                    
                </div>
            </div>
            
            
            <nav class="post-pagination">

                
                <a class="newer-posts" href="localhost/posts/docker%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96/">
			下回<br>Docker数据持久化
                </a>
                
                
                
                <a class="older-posts" href="localhost/posts/docker%E5%AE%B9%E5%99%A8/">
			上回<br>Docker容器
                </a>
                
            </nav>
            <div class="post-comment-wrapper">
                












<script src="https://giscus.app/client.js"
        data-repo="username/repo"
        data-repo-id="**************************"
        data-category="General"
        data-category-id="*********************"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="preferred_color_scheme"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>

            </div>
        </div>
    </div>


                    </div>
            </div><div id="sideContainer" class="side-container">
    
    <a class="a-block nav-head false" href="localhost">
    
        <div class="nav-title">
            My Site
        </div>
        
        <div class="nav-subtitle">
            Themed by Diary.
        </div>
        
    </a>

    <div class="nav-link-list">
        
        
            
            
            
                
            
            
            
            <a class="a-block nav-link-item active" href="localhost/posts">
                Archive
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="localhost/categories">
                Categories
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="localhost/tags">
                Tags
            </a>
            
        
            
            
            
            
            
            <a class="a-block nav-link-item false" href="localhost/index.xml">
                RSS Feed
            </a>
            
        
    </div>

    

    <div class="nav-footer">
        
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	

    </div>
    
</div><div id="extraContainer" class="extra-container">
    <div class="toc-wrapper">
        

        
        <div class="toc">


	<div class="toc-content">
	
		
		
		
		<center>- 目录 -</center>
		
		
		<ul>
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#dockerfile" class="nav-dockerfile">
									Dockerfile
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%8c%87%e4%bb%a4" class="nav-指令">
									指令
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#cmd" class="nav-cmd">
									CMD
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#entrypoint" class="nav-entrypoint">
									ENTRYPOINT
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#cmd%e4%b8%8eentrypoint%e6%80%bb%e7%bb%93" class="nav-cmd与entrypoint总结">
									CMD与ENTRYPOINT总结
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#add" class="nav-add">
									ADD
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#copy" class="nav-copy">
									copy
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
								</ul>
							
						
						
						
							<li>
								<a href="#dockerfile%e6%96%87%e4%bb%b6%e5%86%85%e5%ae%b9" class="nav-dockerfile文件内容">
									Dockerfile文件内容
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%82%ac%e8%99%9a%e9%95%9c%e5%83%8f" class="nav-悬虚镜像">
									悬虚镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e5%88%a0%e9%99%a4%e6%82%ac%e8%99%9a%e9%95%9c%e5%83%8f" class="nav-删除悬虚镜像">
									删除悬虚镜像
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
							
								</ul>
							
						
						
						
							<li>
								<a href="#build-cache" class="nav-build-cache">
									build cache
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
							
								
									<ul>
								
							
						
						
							<li>
								<a href="#%e9%95%9c%e5%83%8f%e7%94%9f%e6%88%90%e8%bf%87%e7%a8%8b" class="nav-镜像生成过程">
									镜像生成过程
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#docker-build-cache%e6%9c%ba%e5%88%b6" class="nav-docker-build-cache机制">
									docker build cache机制
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#build-cache-%e5%a4%b1%e6%95%88" class="nav-build-cache-失效">
									build cache 失效
								</a>
							</li>
						
						
					
				
			
				
				
					
						
						
						
						
						
							<li>
								<a href="#%e6%b8%85%e7%90%86%e6%82%ac%e8%99%9abuild-cache" class="nav-清理悬虚build-cache">
									清理悬虚build cache
								</a>
							</li>
						
						
					
				
			
		</ul>
	</div>

</div>
        
    </div>
    <div class="pagination">
        <a id="globalBackToTop" class="pagination-action animated-visibility" href="#top"
            :class="{ invisible: scrollY == 0 }">
            <i class="material-icons pagination-action-icon">
                keyboard_arrow_up
            </i>
        </a>
        
        <a type="button" class="pagination-action" id="darkModeToggleButton">
            <span class="material-icons pagination-action-icon" id="darkModeToggleIcon">
                dark_mode
            </span>
        </a>
        
        
    </div>
</div><div id="single-column-footer">
Hugo Theme <a href="https://github.com/amazingrise/hugo-theme-diary">Diary</a> by <a href="https://risehere.net/">Rise</a>
<br>
移植自 <a href="https://mak1t0.cc/" target="_blank" rel="noreferrer noopener">Makito</a>'s <a href="https://github.com/SumiMakito/hexo-theme-journal/" target="_blank" rel="noreferrer noopener">Journal.</a> <br>
<br>

&copy;
	
	This is a customized copyright.
	
</div>
            </div>
    
    <script src="/localhost/js/journal.js"></script></body>
</html>
